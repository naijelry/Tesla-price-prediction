import pandas as pd

def clean_missing_values(file_path, output_path):
    """
    Clean the missing values in the stock price data by replacing them with the previous row's values.

    :param file_path: Path to the input CSV file with stock price data
    :param output_path: Path to save the cleaned CSV file
    """
    try:
        # Load the data
        data = pd.read_csv(file_path)

        # Ensure the data is sorted by timestamp
        if 'timestamp' in data.columns:
            data['timestamp'] = pd.to_datetime(data['timestamp'])
            data = data.sort_values('timestamp')

        # Fill missing values in all columns with the previous row's values
        data = data.fillna(method='ffill')

        # Save the cleaned data to a new CSV file
        data.to_csv(output_path, index=False)
        print(f"Cleaned data saved to {output_path}")

    except Exception as e:
        print(f"Error cleaning data: {e}")

if _name_ == "_main_":
    # Input and output file paths
    input_file = "TSLA_minute_data_sample.csv"  # Replace with your actual file name
    output_file = "TSLA_cleaned_minute_data_sample.csv"

    # Clean the missing values
    clean_missing_values(input_file, output_file)